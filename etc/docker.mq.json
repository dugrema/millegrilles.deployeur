{
  "name": "mq",
  "resources": {
    "cpu_limit": 1000000000,
    "mem_limit": 629145600
  },
  "restart_policy": {
    "condition": "any",
    "delay": 30000000000
  },
  "mode": {
    "mode": "replicated",
    "replicas": 1
  },
  "env": [
    "MG_KEY=/run/secrets/key.pem",
    "WEB_KEY=/run/secrets/webkey.pem"
  ],
  "constraints": [
    "node.labels.netzone.private == true",
    "node.labels.millegrilles.mq == true"
  ],
  "container_labels": {
    "ipv6.mapper.network": "mg_ipv6"
  },
  "networks": [{
    "target": "mg_${IDMG}_net",
    "aliases": ["mq"]
  }],
  "labels": {
    "millegrille": "${IDMG}"
  },
  "configs": [
    {
      "name": "pki.mq.cert",
      "filename": "/opt/rabbitmq/dist/certs/cert.pem"
    },
    {
      "name": "pki.millegrille.cert",
      "filename": "/opt/rabbitmq/dist/certs/calist.cert.pem"
    },
    {
      "name": "pki.web.cert;pki.mq.cert",
      "filename": "/opt/rabbitmq/dist/certs/webcert.pem"
    }
  ],
  "secrets": [
    {
      "name": "pki.mq.key",
      "filename": "key.pem"
    },
    {
      "name": "pki.web.key;pki.mq.key",
      "filename": "webkey.pem"
    }
  ]
}
